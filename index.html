<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTT Navigator Web</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        :root { --nav-bg: rgba(0, 0, 0, 0.85); --accent: #00d2ff; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        /* Fullscreen Player Wrapper */
        .ott-container { position: relative; width: 100vw; height: 100vh; display: flex; }
        
        .video-wrapper { flex-grow: 1; position: relative; background: #000; }
        .video-js { width: 100% !important; height: 100% !important; }

        /* Sidebar Navigation like OTT Navigator */
        .ott-sidebar {
            width: 300px;
            background: var(--nav-bg);
            height: 100%;
            position: absolute;
            left: -300px; /* Hidden by default */
            top: 0;
            z-index: 9999;
            transition: 0.3s ease;
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
        }
        .ott-sidebar.open { left: 0; }

        .sidebar-header { padding: 20px; border-bottom: 1px solid #222; }
        .sidebar-header h2 { margin: 0; color: var(--accent); font-size: 18px; text-transform: uppercase; }
        .search-box { width: 90%; padding: 8px; margin-top: 10px; background: #222; border: 1px solid #444; color: #fff; border-radius: 4px; }

        .channel-list { flex-grow: 1; overflow-y: auto; padding: 10px; scrollbar-width: thin; }
        .channel-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 5px;
            cursor: pointer;
            border-radius: 8px;
            transition: 0.2s;
        }
        .channel-item:hover, .channel-item.active { background: rgba(0, 210, 255, 0.2); border-left: 4px solid var(--accent); }
        .channel-item img { width: 40px; height: 40px; border-radius: 4px; object-fit: contain; background: #fff; }
        .channel-info { margin-left: 12px; }
        .channel-info span { display: block; color: #fff; font-size: 14px; font-weight: 500; }
        
        /* Floating Menu Button */
        .menu-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10000;
            background: var(--accent);
            color: #000;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        /* Watermark */
        .ott-watermark { position: absolute; top: 20px; right: 20px; width: 60px; opacity: 0.5; z-index: 100; pointer-events: none; }
    </style>
</head>
<body>

<div class="ott-container">
    <button class="menu-toggle" onclick="toggleMenu()">☰ MENU</button>
    
    <div class="ott-sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>OTT NAVIGATOR</h2>
            <input type="text" class="search-box" placeholder="Search channel..." onkeyup="search(this.value)">
        </div>
        <div class="channel-list" id="list">
            <p style="text-align: center; color: #666;">Loading Channels...</p>
        </div>
    </div>

    <div class="video-wrapper">
        <img id="logo" src="" class="ott-watermark">
        <video id="my-video" class="video-js vjs-big-play-centered" controls preload="auto"></video>
    </div>
</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>

<script>
    const user = "biojio481-web", repo = "Iptv";
    const rawUrl = `https://raw.githubusercontent.com/${user}/${repo}/main/`;
    const m3uUrl = rawUrl + "playlist.m3u";
    const logoUrl = rawUrl + "logo.png";

    document.getElementById('logo').src = logoUrl;
    const player = videojs('my-video');
    let allChannels = [];

    function toggleMenu() {
        document.getElementById('sidebar').classList.toggle('open');
    }

    async function loadData() {
        try {
            const res = await fetch(m3uUrl);
            const text = await res.text();
            const lines = text.split('\n');
            let list = [], cur = {};

            lines.forEach(line => {
                if (line.startsWith('#EXTINF:')) {
                    cur.name = line.split(',')[1]?.trim() || "Live TV";
                    cur.logo = (line.match(/tvg-logo="([^"]+)"/) || [])[1] || logoUrl;
                } else if (line.trim().startsWith('http')) {
                    cur.url = line.trim();
                    list.push({...cur});
                    cur = {};
                }
            });

            allChannels = list;
            render(allChannels);
        } catch (e) {
            document.getElementById('list').innerHTML = "Error loading data.";
        }
    }

    function render(data) {
        const container = document.getElementById('list');
        container.innerHTML = data.map((ch, index) => `
            <div class="channel-item" onclick="playCh('${ch.url}', this)">
                <img src="${ch.logo}" onerror="this.src='${logoUrl}'">
                <div class="channel-info">
                    <span>${ch.name}</span>
                </div>
            </div>
        `).join('');
    }

    function playCh(url, el) {
        player.src({ src: url, type: 'application/x-mpegURL' });
        player.play();
        document.querySelectorAll('.channel-item').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
        if (window.innerWidth < 768) toggleMenu(); // Mobile-এ অটো মেনু বন্ধ হবে
    }

    function search(q) {
        const filtered = allChannels.filter(c => c.name.toLowerCase().includes(q.toLowerCase()));
        render(filtered);
    }

    loadData();
</script>
</body>
</html>
